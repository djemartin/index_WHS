<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Ajouter un Tour</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
<header>
    <nav>
        <a href="/">Accueil</a>
        <a href="/golf">Gérer les Golfs</a>
    </nav>
</header>
<main>
    <h1>Ajouter un Tour</h1>
    <form method="post">
        <label>Nom du Tour <input type="text" name="name" required></label><br>
        <label>Golf joué 
            <select name="golf" id="golf_select" required>
                <option value="">--Choisir--</option>
                {% for g in golfs %}
                <option value="{{ g.doc_id }}">{{ g.name }}</option>
                {% endfor %}
            </select>
            <a href="/golf">+</a>
        </label><br>
        <label>Par du parcours <input type="number" name="par" step="1" required></label><br>
        <label>Slope <input type="number" name="slope" step="1" required></label><br>
        <label>SSS <input type="number" name="sss" step="1" required></label><br>
        <h2>Par par trou</h2>
        <table>
            <thead>
                <tr>
                    <th>Trou</th>
                    <th>Par</th>
                </tr>
            </thead>
            <tbody>
                {% for i in range(1, 19) %}
                <tr>
                    <td>{{ i }}</td>
                    <td><input type="number" name="par_{{ i }}" step="1" required></td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <button type="submit">Enregistrer</button>
    </form>
</main>
<script>
    const golfData = {{ golfs|tojson }};
    function updateGolfInfo(id){
        const g = golfData.find(x => x.doc_id == id);
        if(!g) return;
        document.querySelector('input[name="par"]').value = g.par;
        document.querySelector('input[name="slope"]').value = g.slope;
        document.querySelector('input[name="sss"]').value = g.sss;
    }
    document.addEventListener('DOMContentLoaded', function(){
        const select = document.getElementById('golf_select');
        if(select){
            select.addEventListener('change', function(){
                updateGolfInfo(parseInt(this.value));
            });
            if(select.value){
                updateGolfInfo(parseInt(select.value));
            }
        }
    });
</script>
</body>
</html>
